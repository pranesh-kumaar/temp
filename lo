import streamlit as st
import numpy as np
from sklearn.cluster import FeatureAgglomeration
from scipy.spatial.distance import pdist
from scipy.cluster.hierarchy import linkage, dendrogram
import plotly.graph_objects as go

# Generate sample data (replace with your data)
data = np.random.rand(10, 5)

# Perform Feature Agglomeration
n_clusters = 2
agglomeration = FeatureAgglomeration(n_clusters=n_clusters)
reduced_data = agglomeration.fit_transform(data)

# Calculate dendrogram using linkage and pdist
distances = pdist(reduced_data)
linkage_matrix = linkage(distances, method='ward')

# Create a dendrogram using Plotly
dendro_fig = go.Figure()
dendrogram_fig = dendrogram(linkage_matrix, orientation="top")
dendro_fig.add_trace(go.Scatter(x=dendrogram_fig["icoord"], y=dendrogram_fig["dcoord"], mode="lines"))
dendro_fig.update_layout(title="Dendrogram")
st.plotly_chart(dendro_fig)