import pandas as pd
from sklearn.decomposition import PCA
import matplotlib.pyplot as plt

# Load your dataset
data = pd.read_csv('your_dataset.csv')

# Handle missing values by dropping rows with missing values
data = data.dropna()

# Separate numeric data
numeric_data = data.select_dtypes(include=['number'])

# Apply PCA
pca = PCA()
pca.fit(numeric_data)

# Calculate the variance explained by each principal component
explained_variance = pca.explained_variance_ratio_

# Plot the explained variance
plt.plot(explained_variance, marker='o')
plt.xlabel("Principal Component")
plt.ylabel("Explained Variance")
plt.title("Explained Variance by Principal Components")
plt.show()

# Identify columns with high explained variance
num_top_columns = 5  # You can adjust this number
top_columns_indices = explained_variance.argsort()[-num_top_columns:][::-1]
top_columns = numeric_data.columns[top_columns_indices]

print("Top columns for clustering:", top_columns)